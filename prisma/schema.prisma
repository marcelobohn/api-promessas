generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Candidate {
  id             Int        @id @default(autoincrement())
  name           String
  politicalParty String?    @map("political_party")
  electionId     Int?       @map("election_id")
  election       Election?  @relation(fields: [electionId], references: [id], onDelete: SetNull)
  officeId       Int        @map("office_id")
  office         Office     @relation(fields: [officeId], references: [id], onDelete: Restrict)
  createdAt      DateTime   @default(now()) @map("created_at")
  updatedAt      DateTime   @updatedAt @map("updated_at")
  promises       Promise[]

  @@map("candidates")
}

model Election {
  id          Int         @id @default(autoincrement())
  year        Int         @unique
  description String?
  createdAt   DateTime    @default(now()) @map("created_at")
  updatedAt   DateTime    @updatedAt @map("updated_at")
  candidates  Candidate[]

  @@map("elections")
}

model Promise {
  id          Int               @id @default(autoincrement())
  title       String
  description String?
  status      String            @default("NOT_STARTED")
  progress    Int               @default(0)
  candidateId Int               @map("candidate_id")
  candidate   Candidate         @relation(fields: [candidateId], references: [id], onDelete: Cascade)
  comments    PromiseComment[]
  createdAt   DateTime          @default(now()) @map("created_at")
  updatedAt   DateTime          @updatedAt @map("updated_at")

  @@map("promises")
}

model PromiseComment {
  id        Int      @id @default(autoincrement())
  content   String
  promiseId Int      @map("promise_id")
  promise   Promise  @relation(fields: [promiseId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now()) @map("created_at")

  @@map("promise_comments")
}

model Office {
  id          Int         @id @default(autoincrement())
  name        String      @unique
  description String?
  createdAt   DateTime    @default(now()) @map("created_at")
  updatedAt   DateTime    @updatedAt @map("updated_at")
  candidates  Candidate[]

  @@map("offices")
}
